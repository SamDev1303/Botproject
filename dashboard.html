<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bella OS | Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Plus Jakarta Sans', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: { bella: { bg: '#050505', surface: '#0d0d0d', border: '#1a1a1a', accent: '#6366f1', warning: '#f59e0b', success: '#10b981' } }
                }
            }
        }
    </script>
    <style>
        * { box-sizing: border-box; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #050505; color: #f1f1f1; font-family: 'Plus Jakarta Sans', sans-serif; overflow: hidden; }
        .main-container { display: flex; flex-direction: column; height: 100vh; width: 100vw; padding: 4px; gap: 4px; }
        .glass { background: rgba(13, 13, 13, 0.85); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05); border-radius: 8px; }
        .accent-text { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .custom-scroll::-webkit-scrollbar { width: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .grid-full { display: grid; grid-template-columns: repeat(12, 1fr); gap: 4px; flex: 1; min-height: 0; }
        .box { display: flex; flex-direction: column; padding: 8px; min-height: 0; }
        .label { font-size: 9px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; color: #666; border-bottom: 1px solid #222; margin-bottom: 6px; padding-bottom: 2px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- HEADER ROW: LOGO + STOCKS + VITALS -->
        <header class="glass box flex-row items-center justify-between py-1 px-4 shrink-0">
            <div class="flex items-center gap-4">
                <h1 class="text-base font-black italic accent-text tracking-tighter uppercase leading-none">BELLA OS</h1>
                <div class="flex gap-3 border-l border-white/10 pl-4 overflow-x-auto no-scrollbar items-center" id="stock-ticker">
                    <!-- Ticker -->
                </div>
            </div>
            <div class="flex items-center gap-6">
                <div class="flex gap-4">
                    <div class="text-right"><p class="text-[7px] font-black text-gray-500 uppercase">Rev</p><span class="text-xs font-bold text-white leading-none" id="stat-revenue">--</span></div>
                    <div class="text-right"><p class="text-[7px] font-black text-gray-500 uppercase">Due</p><span class="text-xs font-bold text-bella-warning leading-none" id="stat-invoices">--</span></div>
                    <div class="text-right"><p class="text-[7px] font-black text-gray-500 uppercase">Lead</p><span class="text-xs font-bold text-bella-success leading-none" id="stat-leads">--</span></div>
                </div>
                <div class="flex items-center gap-2 border-l border-white/10 pl-4">
                    <div class="w-1.5 h-1.5 bg-bella-success rounded-full shadow-[0_0_5px_#10b981]"></div>
                    <span class="text-[8px] font-mono text-gray-400" id="last-update">--:--:--</span>
                </div>
            </div>
        </header>

        <!-- MAIN BODY: NO WASTED SPACE -->
        <div class="grid-full">
            <!-- COL 1: OPS & CRONS -->
            <div class="col-span-3 flex flex-col gap-1 min-h-0">
                <div class="glass box flex-1">
                    <div class="label"><span>Neural Streams</span><i class="fas fa-wave-square text-bella-accent"></i></div>
                    <div id="task-list" class="flex-1 overflow-y-auto custom-scroll space-y-1"></div>
                </div>
                <div class="glass box flex-1">
                    <div class="label"><span>Active Crons</span><span class="text-[7px] font-mono" id="cron-count">0</span></div>
                    <div id="cron-list" class="flex-1 overflow-y-auto custom-scroll space-y-1"></div>
                </div>
            </div>

            <!-- COL 2: CORE INTELLIGENCE -->
            <div class="col-span-6 flex flex-col min-h-0">
                <div class="glass box flex-1">
                    <div class="label"><span>Intelligence Patterns</span><i class="fas fa-brain text-bella-accent"></i></div>
                    <div id="history-list" class="flex-1 overflow-y-auto custom-scroll space-y-2 pr-1"></div>
                </div>
            </div>

            <!-- COL 3: PORTFOLIO & SYS -->
            <div class="col-span-3 flex flex-col gap-1 min-h-0">
                <div class="glass box flex-1">
                    <div class="label"><span>Market Depth</span><i class="fas fa-chart-line text-bella-accent"></i></div>
                    <div id="stock-list-side" class="space-y-1 flex-1 overflow-y-auto custom-scroll"></div>
                </div>
                <div class="glass box shrink-0 py-2">
                    <div class="label">System Health</div>
                    <div class="grid grid-cols-2 gap-x-2 text-[8px] font-mono text-gray-400 uppercase">
                        <span>Model</span><span class="text-white text-right">Gemini-3</span>
                        <span>Sec</span><span class="text-bella-success text-right">Guard_ON</span>
                        <span>Push</span><span class="text-white text-right">Live_Sync</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function loadData() {
            try {
                const response = await fetch('dashboard-data.json?t=' + Date.now());
                const data = await response.json();
                document.getElementById('last-update').innerText = new Date(data.updatedAt).toLocaleTimeString();
                document.getElementById('stat-revenue').innerText = data.stats?.revenueMTD || '--';
                document.getElementById('stat-invoices').innerText = data.stats?.unpaidInvoices || '--';
                document.getElementById('stat-leads').innerText = data.stats?.leads || '--';

                if (data.portfolio) {
                    const ticker = document.getElementById('stock-ticker');
                    ticker.innerHTML = data.portfolio.map(s => `
                        <div class="flex items-center gap-1.5 whitespace-nowrap">
                            <span class="text-[9px] font-black text-white">${s.ticker}</span>
                            <span class="text-[8px] font-mono ${s.change >= 0 ? 'text-bella-success' : 'text-red-500'}">${s.change >= 0 ? '+' : ''}${s.change}%</span>
                        </div>
                    `).join('<div class="w-px h-2 bg-white/10 mx-1"></div>');

                    const sideList = document.getElementById('stock-list-side');
                    sideList.innerHTML = data.portfolio.map(s => `
                        <div class="flex justify-between items-center p-1 bg-white/[0.02] border border-white/5 rounded">
                            <span class="text-[8px] font-bold text-gray-200">${s.name}</span>
                            <span class="text-[8px] font-mono text-white">$${s.price}</span>
                        </div>
                    `).join('');
                }

                const cronList = document.getElementById('cron-list');
                document.getElementById('cron-count').innerText = data.crons.length;
                cronList.innerHTML = data.crons.map(c => `
                    <div class="p-1.5 bg-white/[0.03] border border-white/5 rounded">
                        <div class="flex justify-between text-[8px] font-black text-white uppercase tracking-tighter">
                            <span>${c.name}</span><span class="text-bella-accent">${c.schedule.expr}</span>
                        </div>
                    </div>
                `).join('');

                const taskList = document.getElementById('task-list');
                taskList.innerHTML = data.liveTasks.map(t => `
                    <div class="p-1.5 bg-white/[0.03] border border-yellow-500/10 rounded">
                        <p class="text-[8px] font-black text-yellow-500 uppercase leading-none mb-1">${t.label}</p>
                        <p class="text-[9px] text-gray-300 font-medium truncate">${t.status}</p>
                    </div>
                `).join('');

                const historyList = document.getElementById('history-list');
                historyList.innerHTML = data.patterns.map(p => `
                    <div class="p-2 rounded border-l border-bella-success/30 bg-white/[0.02]">
                        <p class="text-[9px] text-gray-200 leading-tight">"${p.description}"</p>
                        <p class="text-[7px] font-black text-gray-600 mt-1 uppercase font-mono">${p.date}</p>
                    </div>
                `).join('');
            } catch (e) { console.error(e); }
        }
        setInterval(loadData, 30000);
        loadData();
    </script>
</body>
</html>
